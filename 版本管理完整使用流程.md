# 版本管理完整使用流程指南

## 📋 目錄
1. [系統架構說明](#系統架構說明)
2. [首次設定流程](#首次設定流程)
3. [新機台建立流程](#新機台建立流程)
4. [現有機台版本指定](#現有機台版本指定)
5. [版本追蹤查詢](#版本追蹤查詢)
6. [維修作業流程](#維修作業流程)
7. [常見問題解答](#常見問題解答)

---

## 📐 系統架構說明

### 雙層版本架構
系統採用雙層版本管理架構，確保完整追溯能力：

```
整機版本配置 (Config Version)
├─ v1.0 → 記錄整機配置版本
├─ v1.1 → 整機設變版本
└─ v2.0 → 大版本更新

零件版本清單 (Component Version)
├─ 控箱區域
│  ├─ 主控板 → v1.0, v1.1, v2.0
│  ├─ 電源供應器 → v1.0, v1.2
│  └─ 繼電器 → v1.0
├─ 機器人機板區域
│  └─ 運算板 → v1.0, v1.5
└─ ...更多零件類型
```

### 版本關聯關係
- **整機版本** = 一組零件配置的快照
- **零件版本** = 單一零件的版本歷史
- 機台可指定整機版本 + 個別零件可覆蓋為不同版本

---

## 🚀 首次設定流程

### 步驟 1：建立整機版本配置

#### 1.1 進入版本管理頁面
```
主選單 → 點擊「版本管理」標籤
```

#### 1.2 新增首個整機版本
```
點擊「+ 新增版本配置」按鈕
填寫以下資訊：
- 版本號碼：1.0
- 版本名稱：F32H 標準配置
- 說明文字：初始標準版本
- 狀態：啟用中 ✅
- 更新日期：2024.01.15
```

#### 1.3 設定零件清單
在零件清單區域逐一添加：
```
區域：控箱區域
零件名稱：主控板 V1
零件版本：1.0
數量：1

區域：控箱區域
零件名稱：電源供應器
零件版本：1.0
數量：2

... (重複添加所有標準零件)
```

💡 **快速方式**：可以使用「F32H-標板」模板快速建立，模板已包含 31 個標準零件。

---

### 步驟 2：建立零件版本清單

#### 2.1 切換到「零件版本清單」標籤
```
版本管理頁面 → 點擊「零件版本清單」標籤
```

#### 2.2 新增零件版本
```
點擊「+ 新增零件版本」
填寫：
- 零件名稱：主控板 V1
- 版本號碼：1.0
- 零件編號：CTL-MCU-001
- 零件分類：控箱區域
- 版本說明：初始版本主控板
- 狀態：啟用中
- 生效日期：2024.01.15
- 供應商：XYZ Electronics
- 備註：標準配置
```

#### 2.3 建立改版記錄
當零件有改版時：
```
新增零件版本：
- 零件名稱：主控板 V1
- 版本號碼：1.1
- 變更說明：修正電壓穩定性問題
- 狀態：啟用中
- 生效日期：2024.03.20

同時將舊版本：
- 版本號碼：1.0
- 狀態：改為「已停用」或「歷史版本」
```

---

## 🆕 新機台建立流程

### 方法 A：使用範本建立（推薦）

#### A.1 選擇範本
```
主選單 → 手動新增 → 選擇機台範本
下拉選單中選擇：「F32H-標板 (31個零件)」
```

#### A.2 填寫基本資料
```
機台 ID：F32H-0123
遊戲機序號：GM-F32H-987654
訂單編號：ORD-2024-045
出貨日期：2024.12.20
標籤：外銷, 越南
```

#### A.3 **選擇配置版本** ⭐ 重點
```
在「整機配置版本」區域：
下拉選單選擇：「1.0 - F32H 標準配置」

系統會自動：
- 載入該版本的所有零件配置
- 預設填入對應的零件版本號
```

#### A.4 調整個別零件版本（如需要）
如果某些零件使用不同版本：
```
在零件列表中找到「主控板 V1」
點擊零件版本下拉選單
選擇：v1.1（新版本）

💡 這樣這台機器就是整體 v1.0 配置，但主控板使用 v1.1
```

#### A.5 填寫序號並儲存
```
逐一填寫每個零件的實際序號
例如：
- 主控板 V1：MCU20241220-001
- 電源供應器：PSU20241220-015
- ...

點擊「💾 儲存機台資料」
```

---

### 方法 B：完全手動建立

#### B.1 建立空白機台
```
主選單 → 手動新增 → 選擇「-- 空白 --」
填寫機台基本資料
```

#### B.2 選擇配置版本
```
同方法 A.3
```

#### B.3 手動新增零件
```
點擊「+ 新增零件」
選擇零件分類：控箱區域
填寫品名：主控板 V1
選擇零件版本：1.0
填寫序號：MCU20241220-001
說明：標準主控板

重複新增其他零件...
```

---

## 🔧 現有機台版本指定

### 情境：已有 50 台機台，需要補充版本資訊

#### 方法 1：逐台編輯（精確控制）

##### 1.1 開啟機台詳情
```
主選單 → 機台紀錄表 → 點擊機台卡片
例如：F32H-0001
```

##### 1.2 點擊編輯
```
點擊右上角「✏️ 編輯機台」按鈕
```

##### 1.3 指定版本
```
在基本資訊區找到「整機配置版本」
下拉選單選擇：「1.0 - F32H 標準配置」

檢查零件列表：
- 如果某零件需要特定版本，點擊該零件的版本下拉選單調整
```

##### 1.4 儲存變更
```
點擊「💾 更新機台資料」
```

##### 1.5 重複處理其他機台
```
返回列表 → 選擇下一台 → 重複步驟
```

---

#### 方法 2：批次匯出編輯匯入（快速批量）

##### 2.1 匯出資料
```
機台紀錄表 → 點擊「自訂匯出」
選擇所有需要的機台
匯出為 JSON 格式
```

##### 2.2 編輯 JSON 檔案
使用文字編輯器（VS Code, Notepad++）：
```json
{
  "id": "F32H-0001",
  "gameSerial": "GM-F32H-123456",
  "orderNo": "ORD-2024-001",
  "shipDate": "2024.01.15",
  "configVersion": "1.0",  // 👈 新增此欄位
  "parts": [
    {
      "category": "控箱區域",
      "desc": "主控板",
      "name": "主控板 V1",
      "sn": "MCU20240115-001",
      "componentVersion": "1.0"  // 👈 新增此欄位
    },
    ...
  ]
}
```

批量替換技巧：
```
使用 VS Code 的「尋找與取代」功能：
1. 尋找："shipDate": "(.*?)",
2. 取代："shipDate": "$1",\n  "configVersion": "1.0",
3. 點擊「全部取代」
```

##### 2.3 重新匯入
```
機台紀錄表 → 點擊「自訂匯出」→ 選擇「匯入 JSON」
選擇編輯好的 JSON 檔案
系統會合併/更新機台資料
```

---

## 🔍 版本追蹤查詢

### 查詢 A：特定版本的所有機台

#### A.1 使用進階篩選
```
機台紀錄表 → 進階篩選
篩選類型：選擇「依配置版本」
篩選值：選擇「v1.0」
```

#### A.2 查看結果
```
顯示所有使用 v1.0 配置的機台清單
可以看到數量統計：「篩選中 (12 筆)」
```

#### A.3 匯出版本報表
```
點擊「報表模板」按鈕
選擇「版本配置報表」
系統生成 Excel 檔案包含：
- Sheet 1: 機台基本資料 + 版本號
- Sheet 2: 零件明細 + 零件版本
```

---

### 查詢 B：某零件的版本使用狀況

#### B.1 進入庫存管理
```
主選單 → 庫存管理
```

#### B.2 搜尋零件
```
在搜尋框輸入：「主控板 V1」
```

#### B.3 查看庫存卡片
```
卡片顯示：
- 零件名稱：主控板 V1
- 當前庫存：15 pcs
- 使用中機台：23 台  // 👈 點擊查看詳情
- 版本：v1.0, v1.1 混用
```

#### B.4 版本分布分析
```
點擊「📊 版本分析」
查看：
- v1.0 使用數量：8 台
- v1.1 使用數量：15 台
```

---

### 查詢 C：機台維修歷史與版本變更

#### C.1 開啟機台詳情
```
機台紀錄表 → 點擊機台 F32H-0050
```

#### C.2 查看產品履歷
```
點擊「📋 產品履歷」按鈕
```

#### C.3 篩選版本變更記錄
```
在履歷列表中會顯示：
🔄 2024.03.25 14:30 - 零件更換
   更換主控板 v1.0 → v1.1
   原因：電壓穩定性問題
   操作人：張工

🔄 2024.06.10 09:15 - 整機升級
   整機版本 v1.0 → v1.2
   說明：季度例行升級
   操作人：李工
```

---

## 🛠️ 維修作業流程

### 情境：機台 F32H-0025 主控板故障，需更換

#### 步驟 1：確認機台現有配置
```
開啟 F32H-0025 詳情頁面
查看資訊卡片：
- 配置版本：v1.0
- 零件總數：31 項
```

#### 步驟 2：檢查零件版本
```
在零件列表找到「主控板 V1」
查看版本標籤：v1.0
記下序號：MCU20240201-045
```

#### 步驟 3：查詢庫存
```
切換到「庫存管理」頁面
搜尋：主控板 V1
查看可用版本：
- v1.0：庫存 3 pcs  ❌ (已停產)
- v1.1：庫存 15 pcs ✅ (建議使用)
- v2.0：庫存 8 pcs  ⚠️ (需整機升級)
```

#### 步驟 4：決定維修方案

##### 方案 A：使用相同版本（理想）
```
如果有 v1.0 庫存：
- 直接更換
- 不需要更新版本記錄
- 只記錄序號變更
```

##### 方案 B：使用新版本（常見）
```
使用 v1.1 替代：
1. 確認 v1.1 向下相容
2. 編輯機台 → 找到主控板
3. 更新版本：v1.0 → v1.1
4. 更新序號：MCU20240201-045 → MCU20241220-新
5. 新增產品履歷：
   類型：零件更換
   說明：主控板故障更換為新版本 v1.1
   更換前：MCU20240201-045 (v1.0)
   更換後：MCU20241220-088 (v1.1)
   更換原因：原零件故障，庫存無 v1.0
```

##### 方案 C：整機升級（複雜）
```
升級到 v2.0 配置：
1. 查看 v2.0 整機配置差異
2. 準備所有需要更換的零件
3. 編輯機台 → 更改整機版本為 v2.0
4. 系統提示需要更新的零件清單
5. 逐一更新零件序號
6. 新增產品履歷：
   類型：整機升級
   從版本：v1.0
   到版本：v2.0
   升級原因：主控板故障，藉機升級整機
```

#### 步驟 5：更新庫存
```
庫存管理 → 找到主控板 V1 v1.1
更新庫存數量：
- 原數量：15
- 更新為：14
- 備註：用於 F32H-0025 維修
```

#### 步驟 6：完成維修記錄
```
儲存機台資料
系統自動記錄：
- 零件版本變更
- 序號變更
- 時間戳記
- 操作人員（當前登入用戶）
```

---

## ❓ 常見問題解答

### Q1: 已經有 50 台機台沒有版本資訊，如何快速補充？

**A1: 推薦批次編輯流程**
```
1. 確定這 50 台機台是否使用相同配置
   - 如果相同 → 使用方法 2（批次匯出編輯匯入）
   - 如果不同 → 先分類再批次處理

2. 批次編輯步驟：
   a. 匯出所有機台資料（JSON 格式）
   b. 用 VS Code 開啟 JSON 檔案
   c. 使用「尋找與取代」功能批量添加 configVersion
   d. 重新匯入系統

3. 時間估算：
   - 手動逐台編輯：50 台 × 2 分鐘 = 100 分鐘
   - 批次編輯：10 分鐘匯出 + 5 分鐘編輯 + 5 分鐘匯入 = 20 分鐘
```

---

### Q2: 整機版本和零件版本有什麼區別？

**A2: 兩者關係**
```
整機版本（Config Version）
- 定義：一個時間點的完整機台配置
- 內容：包含所有零件的標準版本組合
- 用途：快速識別機台是哪個世代的產品
- 範例：v1.0 = 2024年1月標準配置

零件版本（Component Version）
- 定義：單一零件的版本歷史
- 內容：該零件的技術規格、供應商、變更記錄
- 用途：追蹤個別零件的改版歷程
- 範例：主控板有 v1.0, v1.1, v2.0 三個版本

實際應用：
一台機器的整機版本是 v1.0
但其中主控板可能用 v1.1（因為 v1.0 已停產）
這樣就能精確追蹤每個零件的實際版本
```

---

### Q3: 維修時發現庫存沒有原版本零件，如何處理？

**A3: 版本替代策略**
```
步驟 1：確認相容性
- 查看零件版本說明
- 確認新版本是否向下相容
- 諮詢技術部門

步驟 2：使用新版本替代
- 編輯機台零件列表
- 更新該零件的版本號
- 新增產品履歷記錄變更原因

步驟 3：文檔記錄
在產品履歷中詳細記錄：
- 更換日期
- 原版本 / 新版本
- 更換原因
- 測試結果
- 操作人員

範例記錄：
===========================
日期：2024.12.20
機台：F32H-0025
零件：主控板 V1
變更：v1.0 → v1.1
原因：維修需求，v1.0 已停產
測試：✅ 功能正常
人員：張工
===========================
```

---

### Q4: 如何查詢某個版本配置出貨了多少台？

**A4: 版本統計查詢**
```
方法 1：使用進階篩選
1. 機台紀錄表
2. 進階篩選 → 依配置版本 → 選擇 v1.0
3. 查看篩選結果數量

方法 2：匯出報表分析
1. 機台紀錄表 → 報表模板
2. 選擇「版本配置統計」
3. Excel 檔案會包含：
   - 各版本出貨數量
   - 各版本出貨日期範圍
   - 各版本訂單分布

方法 3：使用 Dashboard（如果有）
1. 概覽儀表板
2. 查看「版本分布圖表」
3. 顯示各版本的機台數量占比
```

---

### Q5: 零件改版後，舊版本應該如何處理？

**A5: 版本生命週期管理**
```
階段 1：新版本發布
- 建立新零件版本 v1.1
- 狀態設為「啟用中」
- 舊版本 v1.0 保持「啟用中」
- 兩版本並存供選擇

階段 2：過渡期
- 新機台優先使用 v1.1
- 舊機台維修可選擇 v1.0 或 v1.1
- 監控 v1.0 庫存量

階段 3：停產
- v1.0 庫存低於安全庫存時
- 將 v1.0 狀態改為「已停用」
- 在版本說明加註：「已停產，請使用 v1.1」
- 舊機台維修統一改用 v1.1

階段 4：歷史封存
- 將 v1.0 狀態改為「歷史版本」
- 保留完整資訊供查詢
- 不出現在新機台建立的選項中
- 但在歷史機台中仍可查看

範例時間軸：
2024.01 - v1.0 發布（啟用中）
2024.03 - v1.1 發布（啟用中）v1.0 並存
2024.06 - v1.0 停產（已停用）
2024.12 - v1.0 封存（歷史版本）
```

---

### Q6: 可以批量更新整機版本嗎？

**A6: 批量版本升級**
```
適用情境：
- 季度例行升級
- 批次問題零件更換
- 產線配置統一

操作步驟：
1. 機台紀錄表 → 使用篩選找出目標機台
   例如：篩選 v1.0 版本的所有機台

2. 匯出為 JSON

3. 使用文字編輯器批量替換：
   尋找："configVersion": "1.0"
   取代："configVersion": "1.1"

4. 同時更新需要變更的零件版本：
   尋找："componentVersion": "1.0"
   取代："componentVersion": "1.1"
   （需確認該零件確實需要升級）

5. 重新匯入系統

6. 批量新增產品履歷：
   - 可以用腳本生成履歷記錄
   - 或手動為關鍵機台添加履歷

⚠️ 注意事項：
- 備份原始資料
- 先測試 1-2 台確認無誤
- 確認所有零件版本相容性
- 通知相關人員版本變更
```

---

### Q7: 整機版本配置中的零件清單有什麼用？

**A7: 配置零件清單的作用**
```
作用 1：快速建立機台
- 使用範本時自動載入所有零件
- 預設填入對應版本號
- 減少手動輸入錯誤

作用 2：配置差異比對
- 比較 v1.0 和 v1.1 的差異
- 快速識別哪些零件有變更
- 規劃升級所需物料

作用 3：BOM 表生成
- 自動計算物料需求
- 匯出採購清單
- 庫存需求預測

作用 4：品質追溯
- 發現批次問題時快速定位
- 查詢受影響的機台範圍
- 制定召回或維修計畫

範例使用：
假設發現主控板 v1.0 有批次問題
1. 查看整機版本配置 v1.0
2. 確認使用的是主控板 v1.0
3. 篩選所有 v1.0 配置的機台（23 台）
4. 檢查這些機台是否有更換過主控板
5. 通知客戶預防性檢查
```

---

## 📈 進階應用案例

### 案例 1：季度批次升級

**背景**：每季度統一升級所有機台到最新配置

**流程**：
```
Q1 準備階段（升級前 1 個月）
1. 建立新整機版本 v1.3
2. 定義所有零件的目標版本
3. 計算物料需求
4. 採購零件確保庫存充足

Q2 通知階段（升級前 2 週）
1. 匯出所有需升級機台清單
2. 通知客戶升級計畫
3. 安排升級時程

Q3 執行階段
1. 批量匯出機台資料
2. 編輯 JSON 更新版本號
3. 重新匯入系統
4. 實際執行硬體升級
5. 更新零件序號

Q4 追蹤階段
1. 產品履歷記錄升級
2. 統計升級完成率
3. 追蹤升級後問題
```

---

### 案例 2：問題零件召回

**背景**：發現某批次主控板有品質問題

**流程**：
```
1. 識別問題範圍
   - 零件：主控板 v1.0
   - 生產日期：2024.02.01 - 2024.02.15
   - 序號範圍：MCU20240201-001 ~ MCU20240215-999

2. 查詢受影響機台
   篩選條件：
   - 零件版本 = 主控板 v1.0
   - 出貨日期 = 2024.02.01 ~ 2024.03.31
   - 結果：12 台機台

3. 匯出詳細清單
   包含：
   - 機台 ID
   - 客戶資訊
   - 出貨日期
   - 主控板序號

4. 執行召回更換
   - 寄送新主控板 v1.1
   - 客戶自行更換或派工更換
   - 更新機台零件版本
   - 記錄產品履歷

5. 追蹤完成度
   - 已更換：8 台 ✅
   - 進行中：3 台 🔄
   - 待確認：1 台 ⏳
```

---

### 案例 3：客製化配置管理

**背景**：不同區域市場需要不同配置

**流程**：
```
建立區域專用版本：
v1.0-TW 台灣版本
- 電壓：110V
- 語言：繁體中文
- 特殊零件：台灣法規認證電源

v1.0-VN 越南版本
- 電壓：220V
- 語言：越南文
- 特殊零件：越南認證電源

v1.0-US 美國版本
- 電壓：120V
- 語言：英文
- 特殊零件：UL 認證電源

使用標籤搭配版本：
機台 F32H-0050
- 配置版本：v1.0-VN
- 標籤：外銷, 越南, 220V
- 出貨地：Ho Chi Minh City
```

---

## 🎯 最佳實踐建議

### 1. 版本命名規範
```
主版本.次版本.修訂版
- 主版本：重大架構變更（v1.0 → v2.0）
- 次版本：功能改進（v1.0 → v1.1）
- 修訂版：Bug 修正（v1.1.0 → v1.1.1）

範例：
v1.0 - 初始版本
v1.1 - 改進電源穩定性
v1.2 - 新增溫度監控
v2.0 - 全新主控架構
```

### 2. 版本狀態管理
```
啟用中：當前正在使用的版本
已停用：已停產但可查詢的版本
歷史版本：僅供歷史記錄的版本
測試中：開發階段尚未正式發布
```

### 3. 文檔完整性
```
每個版本必須包含：
✅ 版本號碼
✅ 版本名稱
✅ 詳細說明
✅ 更新日期
✅ 零件清單（整機版本）
✅ 變更記錄
✅ 相容性說明
```

### 4. 定期審查
```
月度審查：
- 檢查版本使用分布
- 評估庫存與版本匹配度
- 規劃淘汰舊版本

季度審查：
- 評估是否需要新版本
- 總結版本變更效益
- 優化版本管理流程
```

---

## 📞 技術支援

如有任何問題，請聯繫：
- 技術部門：ext. 1234
- 系統管理員：admin@company.com
- 文檔最後更新：2024.12.20

---

**版本**：v1.0
**作者**：系統管理員
**適用系統**：電規追蹤系統 v3.0+
